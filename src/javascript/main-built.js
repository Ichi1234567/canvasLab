/*! Copyright (c) 2011 Brandon Aaron (http://brandonaaron.net)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 * Thanks to: Seamus Leahy for adding deltaX and deltaY
 *
 * Version: 3.0.6
 * 
 * Requires: 1.2.2+
 */
((function(){define("geom/geom",[],function(){var a;return a={lookAt:function(a,b){var c,d,e,f,g,h,i,j;c=b.cb?b.cb:function(){},j=b.w,h=b.h,e=b.ctx;if(a&&a.length===2)return d=[j/2,h/2],f=d[0]-a[0],g=d[1]-a[1],e.map(function(a){return a.setTransform(1,0,0,1,f,g)}),i=[1,0,0,1,f,g],c(i)},scale:function(a,b){var c,d,e,f,g,h,i;c=b.cb?b.cb:function(){},f=b.display,e=f.ctx,d=b.center;if(a&&a.length===2)return g=d[0]-d[0]*a[0],h=d[1]-d[1]*a[1],e.map(function(b){return b.transform(a[0],0,0,a[1],g,h)}),i=[a[0],0,0,a[1],g,h],c(i)},move:function(a,b){var c,d,e,f,g;c=b.cb?b.cb:function(){},f=b.display,e=f.ctx,d=b.center;if(a&&a.length===2)return e.map(function(b){return b.transform(1,0,0,1,a[0],a[1])}),g=[1,0,0,1,a[0],a[1]],c(g)},transform:function(a,b){var c,d,e,f,g;c=b.cb?b.cb:function(){},f=b.display,e=f.ctx,d=b.center;if(a&&a.length===6)return e.map(function(b){return b.transform(a[0],a[1],a[2],a[3],a[4],a[5])}),g=[a[0],a[1],a[2],a[3],a[4],a[5]],c(g)},rotate:function(a,b){var c,d,e,f,g,h,i;c=b.cb?b.cb:function(){},g=b.display,f=g.ctx,d=b.center;if(typeof a=="number")return e=[d[0]*Math.cos(a)+d[1]*Math.sin(a),-d[0]*Math.sin(a)+d[1]*Math.cos(a)],i=[d[0]-e[0],d[1]-e[1]],f.map(function(b){return b.transform(Math.cos(a),-Math.sin(a),Math.sin(a),Math.cos(a),i[0],i[1])}),h=[Math.cos(a),-Math.sin(a),Math.sin(a),Math.cos(a),i[0],i[1]],c(h)},unwrapMtx:function(b,c){var d;return d=[1,0,0,1,0,0],b.forEach(function(b){var e,f,g,h,i,j,k;h=b[0],i=b[1],j=b[2];if(j)for(e in j)g=j[e],c[g]=e;if(typeof a[h]=="function")return k=[],f=function(a){return k[0]=a[0]*d[0]+a[2]*d[1],k[1]=a[1]*d[0]+a[3]*d[1],k[2]=a[0]*d[2]+a[2]*d[3],k[3]=a[1]*d[2]+a[3]*d[3],k[4]=a[0]*d[4]+a[2]*d[5]+a[4],k[5]=a[1]*d[4]+a[3]*d[5]+a[5],d=k},c.cb=f,a[h](i,c)}),["transform",d]}},a})})).call(this),function(){define("display/paint",[],function(){var a,b;return a={noFace:function(a){var b,c,d,e,f,g,h;d=a.data,c=a.ctx,b=a.cb?a.cb:function(){},h=d.vnum,f=d.v,c.beginPath(),c.moveTo(f[0][0],f[0][1]);for(e=1;1<=h?e<=h:e>=h;1<=h?e++:e--)g=f[e],c.lineTo(g[0],g[1]);return b()},hasFace:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;e=a.data,d=a.ctx,c=a.cb?a.cb:function(){},o=a.type,j=e.fnum,f=e.f,p=e.v;switch(o){case"fill":n=function(a,b,c){var d,e;return d=a.split("/"),e=parseInt(d[0]),c.lineTo(b[e][0],b[e][1]),!1};break;default:n=function(a,b,c,d){var e,f;return e=a.split("/"),f=parseInt(e[0]),d?c.moveTo(b[f][0],b[f][1]):c.lineTo(b[f][0],b[f][1]),d=e.length>1?!parseInt(e[1]):!1,d}}s=[];for(k=0,q=f.length;k<q;k++){h=f[k],d.beginPath(),b=!0;for(m=0,r=h.length;m<r;m++)i=h[m],b=n(i,p,d,b);g=h[0].split("/"),l=parseInt(g[0]),b?d.moveTo(p[l][0],p[l][1]):d.lineTo(p[l][0],p[l][1]),s.push(c())}return s}},b={polyEdge:function(b,c){var d,e,f;d=c.ctx,e=c.mode,f=c.style_edge;if(e==="SKELETON")return b.f&&a.hasFace({data:b,ctx:d,cb:function(){return f&&display.setStyle(f),d.stroke()}}),!b.f&&a.noFace({data:b,ctx:d,cb:function(){return f&&display.setStyle(f),d.stroke()}})},polyFill:function(b,c){var d,e;return d=c.ctx,e=c.style_fill,a.hasFace({data:b,ctx:d,type:"fill",cb:function(){return e&&display.setStyle(e),d.fill()}})},cirEdge:function(a,b){var c,d,e,f,g;return c=b.ctx,d=b.mode,f=b.style_edge,d==="SKELETON"&&(g=a.v,e=a.r,c.beginPath(),c.arc(g[0][0],g[0][1],e,0,Math.PI*2,!1),c.closePath()),f&&display.setStyle(f),c.stroke()},cirFill:function(a,b){var c,d,e,f;return c=b.ctx,e=b.style_fill,f=a.v,d=a.r,c.beginPath(),c.arc(f[0][0],f[0][1],d,0,Math.PI*2,!1),c.closePath(),e&&display.setStyle(e),c.fill()}},b})}.call(this),function(){define("display/canvas",["../geom/geom","display/paint"],function(a,b){var c;return console.log("---cache---"),c=Backbone.Model.extend({clear:function(a){var b,c,d,e,f;return e=a.x,f=a.y,d=a.w,c=a.h,b=a.ctx,b.setTransform(1,0,0,1,e,f),b.clearRect(e,f,d,c)},reset:function(a){return this.lookat=[this.w/2,this.h/2]},setStyle:function(a){var b,c,d,e;b=a.ctx,delete a.ctx,e=[];for(d in a)c=a[d],e.push(b[c]=d);return e},lookAt:function(b){var c;return b=b&&b.length===2?b:null,b&&(this.lookat=b.map(function(a){return a}),c={at:b,ctx:this.ctx,w:this.w,h:this.h},a.lookAt(b,c)),this},updateCanvas:function(c){var d,e,f,g,h,i,j,k,l,m,n,o;k=c.mode,n=c.objs,e=c.cb?c.cb:function(){},d=c.canvas,f=c.ctx;for(i=0,o=n.length;i<o;i++){m=n[i],g=m.data,l=k?k:g.mode;switch(l){case"SKELETON":h=function(a,c){return!a.r&&b.polyEdge(a,c),a.r&&b.cirEdge(a,c)};break;case"ONLYFACE":h=function(a,c){return!a.r&&b.polyFill(a,c),a.r&&b.cirFill(a,c)};break;default:k="GENERAL",h=function(a,c){return a.r&&(b.cirFill(a,c),b.cirEdge(a,c)),a.f&&b.polyFill(a,c),!a.r&&b.polyEdge(a,c)}}j=a.unwrapMtx(g.mtxScript,{display:this,center:g.cp}),c.cache||m.reset().pushMtx(j[0],j[1]).updateCache(),h(g,{ctx:f,display:this,mode:l,style_edge:c.style_edge?c.style_edge:null,style_fill:c.style_fill?c.style_fill:null})}return e(),k}}),c})}.call(this),function(){var a=Object.prototype.hasOwnProperty,b=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};define("display/cache",["display/canvas"],function(a){var c;return console.log("---cache---"),c=function(a){function c(){c.__super__.constructor.apply(this,arguments)}return b(c,a),c.prototype.initialize=function(a){var b,c;return this.x=a.x,this.y=a.y,this.w=a.width,this.h=a.height,this.mtx=a.mtx,this.canvas=[$("<canvas></canvas>")],b=this.canvas[0].get(0),b.width=this.w,b.height=this.h,this.ctx=[b.getContext("2d")],c=this.ctx[0],c.setTransform(1,0,0,1,this.x,this.y),c.lineCap="round",c.lineJoin="round",this},c.prototype.clear=function(a){return a=a?a:{},a.ctx=this.ctx[0],a.x=a.x?a.x:this.x,a.y=a.y?a.y:this.y,a.w=a.w?a.w:this.w,a.h=a.h?a.h:this.h,ctx.setTransform(1,0,0,1,a.x,a.y),c.__super__.clear.call(this,a),this},c.prototype.setStyle=function(a){return a=a?a:{},a.ctx=this.ctx[0],c.__super__.setStyle.call(this,a),this},c.prototype.reset=function(a){return c.__super__.reset.call(this,a),this},c.prototype.updateCanvas=function(a){var b,d,e;return console.log("cache update"),a=a?a:{},this.mtx=a.mtx?a.mtx:this.mtx,b=this.canvas[0],d=this.ctx[0],a.canvas=b,a.ctx=d,a.cache=!0,d.save(),e=c.__super__.updateCanvas.call(this,a),d.restore(),this.mode=e,this},c}(a),c})}.call(this),function(){define("objData/objData",["../display/cache"],function(a){var b,c;return console.log("---objData---"),c=function(a){var b,c,d;return c={v:[],f:[]},b=a.split("\n"),d=[0,0],b.forEach(function(a){var b,e,f;if(a.length){f=a.split(" "),b=f[0].replace("_","");switch(!0){case/^v/g.test(a):case/_cp/g.test(a):return e=f.slice(1),!c[b]&&(c[b]=[]),b!=="cp"?(d.forEach(function(a,b){return e[b]=parseFloat(e[b]),d[b]+=e[b],c.min||(c.min=[],c.max=[]),typeof c["min"][b]!="number"&&(c.min[b]=e[b],c.max[b]=e[b]),c.min[b]=Math.min(c.min[b],e[b]),c.max[b]=Math.max(c.max[b],e[b])}),c[b].push(e)):e.forEach(function(a){return c[b].push(parseFloat(a))});case/^f/g.test(a):return e=f.slice(1),c[b].push(e);case/^_g/g.test(a):case/^_v/g.test(a):case/^_f/g.test(a):case/^r/g.test(a):return e=f[1],(b==="f"||b==="v")&&(b+="num"),b!=="g"&&(e=parseFloat(e)),c[b]=e;default:return e=f.slice(1),c[b]=e}}}),!c.g&&(c.g=""),!c.vnum&&(c.vnum=c.v.length),!c.fnum&&(c.fnum=c.f.length),!c.cp&&(c.cp=[d[0]/c.vnum,d[1]/c.vnum]),c.r?(c.size=[],c.size=[2*c.r,2*c.r],c.cp.forEach(function(a,b){var d;return d=c.r,c.min[b]=a-d,c.max[b]=a+d,c.size[b]=2*d})):(c.size=[],c.min.forEach(function(a,b){return c.size[b]=c.max[b]-c.min[b]})),c},b=Backbone.Model.extend({initialize:function(a){return a[1]==="success"&&(this.data=c(a[0]),this.data.mtxScript=[],this.data.mode="GENERAL",this.parent=a.parent?a.parent:null,this.children=a.children?a.children:[]),this},reset:function(a){return this.data.mtxScript=[],this},pushMtx:function(a,b,c){return this.data.mtxScript.push([a,b,c]),this},cache:function(b){var c,d;return b=b?b:{},c=this.data.min,d=this.data.size,b.x=c[0],b.y=c[1],b.w=d[0],b.h=d[1],b.mtx=this.data.mtxScript,this.cache=new a(b),this},updateCache:function(a){return console.log("updateCache"),a=a?a:{},a.mtx=this.data.mtxScript,a.objs=[this],this.cache.updateCanvas(a),this},_hitTest:function(){var a;return a=!1,a},mouseover:function(a){var b;return a=a?a:{},b=a.pt,b&&console.log(b),this},isIn:function(a){var b,c;return c=!1,b=a.pt,c},pt2local:function(){}}),b})}.call(this),function(){var a=Object.prototype.hasOwnProperty,b=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};define("display/display",["display/canvas"],function(a){var c;return console.log("---display---"),c=function(a){function c(){c.__super__.constructor.apply(this,arguments)}return b(c,a),c.prototype.initialize=function(a){return console.log("init - display"),this.objs=[],this.current=0,this.w=a.width,this.h=a.height,this.canvas=[$("<canvas></canvas>").css({display:"block",border:"1px solid black"}),$("<canvas></canvas>").css({display:"none",border:"1px solid black"})],this.canvas[0].get(0).width=this.w,this.canvas[0].get(0).height=this.h,this.canvas[1].get(0).width=this.w,this.canvas[1].get(0).height=this.h,this.ctx=[this.canvas[0].get(0).getContext("2d"),this.canvas[1].get(0).getContext("2d")],this.ctx[0].lineCap="round",this.ctx[1].lineCap="round",this.ctx[0].lineJoin="round",this.ctx[1].lineJoin="round",a.display.append(this.canvas[0]).append(this.canvas[1]),this.lookat=[this.w/2,this.h/2],this.enableEvts(),this},c.prototype.switchCanvas=function(a){var b,c,d;return a=a?a:{},d=a.prev,b=a.current,c=["block","none"],this.clear(),this.canvas[b].css("display",c[0]),this.canvas[d].css("display",c[1]),this.current=b,this},c.prototype.clear=function(a){return a=a?a:{},a.ctx=this.ctx[this.current],a.x=a.x?a.x:0,a.y=a.y?a.y:0,a.w=a.w?a.w:this.w,a.h=a.h?a.h:this.h,c.__super__.clear.call(this,a),this},c.prototype.setStyle=function(a){return a=a?a:{},a.ctx=this.ctx[this.current],c.__super__.setStyle.call(this,a),this},c.prototype.reset=function(a){return c.__super__.reset.call(this,a),this},c.prototype.pushObj=function(a){var b,c,d;return a=a?a:{},b=a.clear?!0:!1,c=this.objs.length,d=b?c:0,a.obj&&this.objs.splice(c,d,a.obj),this},c.prototype.updateCanvas=function(a){var b,d,e,f,g,h,i;return i=this.current,f=(this.current+1)%2,this.switchCanvas({prev:i,current:f}),d=this.canvas[f],e=this.ctx[f],h=this.ctx[i],a.objs=this.objs,a.canvas=d,a.ctx=e,b=this.lookat,this.lookAt(b),e.save(),h.save(),g=c.__super__.updateCanvas.call(this,a),e.restore(),h.restore(),this.mode=g,this},c.prototype.enableEvts=function(){var a,b;return b=this,a=this.canvas,a.map(function(a){return a.bind({mousedown:function(a){var c;return console.log("down"),c=[a.offsetX,a.offsetY],b._handleEvts({pt:c,e:a})},mouseup:function(a){return console.log("up")},mouseover:function(a){return console.log("over")},mouseout:function(a){return console.log("out")},click:function(a){return console.log("click")},dblclick:function(a){return console.log("dblclick")}})}),this},c.prototype.disableEvts=function(){return this},c.prototype._handleEvts=function(a){var b,c,d,e,f;return e=a.pt,c=this.ctx[this.current],d=this.h,f=this.w,b=c.getImageData(e[0],e[1],1,1).data,b[3]&&this.getObjectsUnderPoint(a),this},c.prototype.getObjectsUnderPoint=function(a){var b;return b=null,b},c}(a),c})}.call(this),function(){var a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],b=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,c=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,d=typeof location!="undefined"&&location.href,e=d&&location.protocol&&location.protocol.replace(/\:/,""),f=d&&location.hostname,g=d&&(location.port||void 0),h=[];define("text",[],function(){var l,m,s;return typeof window!="undefined"&&window.navigator&&window.document?m=function(a,b){var c=l.createXhr();c.open("GET",a,!0),c.onreadystatechange=function(){c.readyState===4&&b(c.responseText)},c.send(null)}:typeof process!="undefined"&&process.versions&&process.versions.node?(s=require.nodeRequire("fs"),m=function(a,b){var c=s.readFileSync(a,"utf8");c.indexOf("﻿")===0&&(c=c.substring(1)),b(c)}):typeof Packages!="undefined"&&(m=function(a,b){var c=new java.io.File(a),d=java.lang.System.getProperty("line.separator"),c=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(c),"utf-8")),e,f,g="";try{e=new java.lang.StringBuffer,(f=c.readLine())&&f.length()&&f.charAt(0)===65279&&(f=f.substring(1));for(e.append(f);(f=c.readLine())!==null;)e.append(d),e.append(f);g=String(e.toString())}finally{c.close()}b(g)}),l={version:"1.0.7",strip:function(a){if(a){var a=a.replace(b,""),d=a.match(c);d&&(a=d[1])}else a="";return a},jsEscape:function(a){return a.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")},createXhr:function(){var b,c,d;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;for(c=0;c<3;c++){d=a[c];try{b=new ActiveXObject(d)}catch(e){}if(b){a=[d];break}}if(!b)throw Error("createXhr(): XMLHttpRequest not available");return b},get:m,parseName:function(a){var b=!1,c=a.indexOf("."),d=a.substring(0,c),a=a.substring(c+1,a.length),c=a.indexOf("!");return c!==-1&&(b=a.substring(c+1,a.length),b=b==="strip",a=a.substring(0,c)),{moduleName:d,ext:a,strip:b}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(a,b,c,d){var e=l.xdRegExp.exec(a),f;return e?(a=e[2],e=e[3],e=e.split(":"),f=e[1],e=e[0],(!a||a===b)&&(!e||e===c)&&(!f&&!e||f===d)):!0},finishLoad:function(a,b,c,d,e){c=b?l.strip(c):c,e.isBuild&&(h[a]=c),d(c)},load:function(a,b,c,h){if(h.isBuild&&!h.inlineText)c();else{var j=l.parseName(a),k=j.moduleName+"."+j.ext,m=b.toUrl(k),n=h&&h.text&&h.text.useXhr||l.useXhr;!d||n(m,e,f,g)?l.get(m,function(b){l.finishLoad(a,j.strip,b,c,h)}):b([k],function(a){l.finishLoad(j.moduleName+"."+j.ext,j.strip,a,c,h)})}},write:function(a,b,c){if(b in h){var d=l.jsEscape(h[b]);c.asModule(a+"!"+b,"define(function () { return '"+d+"';});\n")}},writeFile:function(a,b,c,d,e){var b=l.parseName(b),f=b.moduleName+"."+b.ext,g=c.toUrl(b.moduleName+"."+b.ext)+".js";l.load(f,c,function(){var b=function(a){return d(g,a)};b.asModule=function(a,b){return d.asModule(a,g,b)},l.write(a,f,b,e)},e)}}})}(),define("text!../tmpl/objInf.hbs",[],function(){return"<h3>OBJ DATA - {{name}}</h3>\n<p>v_num：{{vnum}}</p>\n<p>f_num：{{fnum}}</p>\n<p>_cp：{{cp}}</p>\n<p>( w , h )：( {{size}} )</p>\n{{#rinf}}\n<p>r：{{r}}</p>\n{{/rinf}}\n<p>v：<ul>\n    {{#va}}\n        <li>( {{v}} )</li>\n    {{/va}}\n</ul></p>\n{{#fa}}\n<p>f：<ul>\n    <li>{{f}}</li>\n</ul></p>\n{{/fa}}\n"}),function(a){function d(b){var c=b||window.event,d=[].slice.call(arguments,1),e=0,f=!0,g=0,h=0;return b=a.event.fix(c),b.type="mousewheel",c.wheelDelta&&(e=c.wheelDelta/120),c.detail&&(e=-c.detail/3),h=e,c.axis!==undefined&&c.axis===c.HORIZONTAL_AXIS&&(h=0,g=-1*e),c.wheelDeltaY!==undefined&&(h=c.wheelDeltaY/120),c.wheelDeltaX!==undefined&&(g=-1*c.wheelDeltaX/120),d.unshift(b,e,g,h),(a.event.dispatch||a.event.handle).apply(this,d)}var b=["DOMMouseScroll","mousewheel"];if(a.event.fixHooks)for(var c=b.length;c;)a.event.fixHooks[b[--c]]=a.event.mouseHooks;a.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var a=b.length;a;)this.addEventListener(b[--a],d,!1);else this.onmousewheel=d},teardown:function(){if(this.removeEventListener)for(var a=b.length;a;)this.removeEventListener(b[--a],d,!1);else this.onmousewheel=null}},a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})}(jQuery),define("vender/jq-plugin/jquery.mousewheel",function(){}),function(){require(["objData/objData","display/display","text!../tmpl/objInf.hbs","vender/jq-plugin/jquery.mousewheel"],function(a,b,c){var d,e,f;return console.log("---main-read2---"),e=Backbone.View.extend({initialize:function(){},render:function(a){var b;return this.remove(),b=Mustache.render(c,a),this.$el.append($(b))},remove:function(){return this.$el.empty()}}),d=Backbone.View.extend({initialize:function(a){return this.objs=[],this.display=null,this.info=new e({el:"#obj-inf"}),this},events:{"change input[name=shape]":"readObj","change input[name=mode]":"mode_change","click #all-reset":"allreset_click","click #loadModelCenter":"center_obj","click #setLookAt":"set_lookat","click #clearMtx":"clearMtx","click #pushMtx":"pushMtx","mousewheel canvas":"wheelFn"},readObj:function(b){var c,d,e,f;return e=b.target,c=$(e).attr("val"),f=this,d=f.routines,$.ajax({type:"GET",url:c,contentType:"application/x-www-form-urlencoded;charset=utf-8"}).done(function(){var b,c;return c=new a(arguments),f.objs=[c],b=function(a){return f.display=a.display,console.log(f)},d.doneFn(c,{view:f})}).fail(function(){return alert("The file cant be found.")})},mode_change:function(){var a,b,c,d;b=this.display,c=this.objs,d=this.routines;if(b&&c.length)return b.updateCanvas({mode:$("input[name=mode]:checked").attr("val"),cb:function(){}}),a=c[0].data,d.initMtx({at:a.cp})},allreset_click:function(){var a,b,c;return a=this.display,b=this.objs[0],c=this.routines,c.initMtx({display:a,objData:b})},center_obj:function(){var a,b,c;return a=this.display,b=this.objs[0],c=this.routines,c.initMtx({at:b.data.cp,display:a,objData:b})},set_lookat:function(){var a,b,c,d;b=this.display,c=this.objs[0],d=this.routines,a=d.dataOut("lookat");if(a)return d.setLookMtx(a,{display:b,objData:c})},clearMtx:function(){return $(".local").each(function(){return $(this).val("")})},pushMtx:function(){var a,b,c,d,e,f,g,h,i;h=this.routines,a=h.dataOut,e=this.objs,b=this.display;if(e[0]&&b)return d=e[0],c=a("mv"),c&&d.pushMtx("move",c),i=a("scale"),i&&d.pushMtx("scale",i),g=$(".angle").eq(0).val(),f=/^-?\d+.?\d*$/g.test(g)?parseFloat(g):!1,g&&d.pushMtx("rotate",f),b.updateCanvas({objs:e,mode:$("input[name=mode]:checked").attr("val"),cb:function(){}})},wheelFn:function(a,b){var c;if(this.display&&this.objs.length)return c=b>0?.5:1.5,this.objs[0].pushMtx("scale",[c,c]),$(".scale").each(function(){return $(this).val(c)}),this.display.updateCanvas({objs:this.objs,mode:$("input[name=mode]:checked").attr("val"),cb:function(){}})},routines:{dataOut:function(a){var b,c;return b=[],c=!0,$("."+a).each(function(){var a;return a=$(this).val(),c=c&&/^-?\d+.?\d*$/g.test(a),b.push(parseFloat(a))}),b=c?b:c,b},initMtx:function(a){var b,c;a=a?a:{},b=a.display,c=a.objData;if(b&&c)return $(".mv").val("0"),$(".scale").val("1"),$(".angle").val("0"),c.reset(),this.setLookMtx(a.at,a)},setLookMtx:function(a,b){var c,d,e;b=b?b:{},d=b.display,e=b.objData,a=a?a:null;if(d&&e)return d.reset().lookAt(a).updateCanvas({objs:[e],mode:$("input[name=mode]:checked").attr("val"),cb:function(){}}),c=$(".lookat"),d.lookat.forEach(function(a,b){return c.eq(b).val(a)})},doneFn:function(a,c){var d,e,f,g,h,i,j;return c=c?c:{},d=c.cb?c.cb:function(){},j=c.view,f=j.display,g=a,e=a.data,i=e.g?e.g:"--",$("#ctx-title").html(i),h={},e.g&&(h.name=e.g),h.vnum=e.vnum,e.fnum&&(h.fnum=e.fnum),h.rinf=!1,e.r&&(h.rinf={},h.rinf.r=e.r),h.cp=e.cp.join(" , "),h.size=e.size.join(" , "),h.va={},function(a){return h.va=a.map(function(a){return{v:a.join(" , ")}})}(e.v),h.fa=!1,e.f&&(h.fa={},function(a){return h.fa=a.map(function(a){return{f:a.join(" , ")}})}(e.f)),j.info.render(h),f||(f=(new b({display:$("#render"),width:750,height:600})).pushObj({clear:!0,obj:a}),j.display=f,a.cache()),this.initMtx({at:e.cp,display:f,objData:g}),d()}}}),f=new d({el:"body"})})}.call(this),define("main-reader2",function(){})